ui_tool_ent_rail = [
    uitext Rail

    @(ui_tool_ent_flags_group rail $tool_ent_rail_flags [
        "Rotate yaw"
        "Rotate pitch"
        "Aim at followed"
        "Spline"
        "Calc. speed"
        "Follow prev. node"
        "Follow next node"
    ])

    ui_tool_ent_param_group "Length" [
        ui_tool_numinput @@(tool_ent_attr rail time) 0 10000 100 [
            @@@(ui_tool_ent_attr_props rail time)
            uit_val_format = i
            uit_label = (? $tool_ent_attr_flags_setspeed "" "Milliseconds")
        ]

        ui_tool_numinput @@(tool_ent_attr rail rotlen) 0 10000 100 [
            @@@(ui_tool_ent_attr_props rail rotlen)
            uit_val_format = i
            uit_label = (? $tool_ent_attr_flags_setspeed "Rotate len." "Rotate len. (ms)")
        ]

        ui_tool_numinput @@(tool_ent_attr rail rotwait) 0 10000 100 [
            @@@(ui_tool_ent_attr_props rail rotwait)
            uit_val_format = i
            uit_label = "Rotation wait (ms)"
        ]
    ]

    ui_tool_ent_param_group "Direction" [
        uigrid 2 0 0 [
            ui_tool_numinput @@@(tool_ent_attr rail yaw) 0 360 1 [
                @@@@(ui_tool_ent_attr_props rail yaw)
                uit_label = "Yaw"
                uit_val_format = i
                uit_circular = 1
            ]

            ui_tool_button [
                uit_icon = "textures/icons/camera"
                uit_icon_size = 0.015
                uit_icon_align = 0
                uit_tip_simple = "Yaw from camera"
                uit_on_click = [
                    tool_param_set @@@@@(tool_ent_attr rail yaw) (toint (round (getcamerayaw))) [
                        tool_ent_attr_change rail $tool_ent_rail_idx_yaw
                    ]
                ]
            ]

            ui_tool_numinput @@@(tool_ent_attr rail pitch) -90 90 1 [
                @@@@(ui_tool_ent_attr_props rail pitch)
                uit_label = "Pitch"
                uit_val_format = i
            ]

            ui_tool_button [
                uit_icon = "textures/icons/camera"
                uit_icon_size = 0.015
                uit_icon_align = 0
                uit_tip_simple = "Pitch from camera"
                uit_on_click = [
                    tool_param_set @@@@@(tool_ent_attr rail pitch) (toint (round (getcamerapitch))) [
                        tool_ent_attr_change rail $tool_ent_rail_idx_pitch
                    ]
                ]
            ]
        ]
    ]

    @(ui_tool_ent_flags_group rail $tool_ent_rail_collide [
        "Kill on touch"
        "No passengers"
    ] collide "Collision")

    ui_tool_ent_param_group "Animation" [
        ui_tool_searchselect @@(tool_ent_attr rail anim) [
            @@@(ui_tool_ent_attr_props rail anim)
            uit_label = "Type"
            uit_list = $tool_mapmodel_anims
        ]

        ui_tool_numinput @@(tool_ent_attr rail aspeed) 0 1000 1 [
            @@@(ui_tool_ent_attr_props rail aspeed)
            uit_label = "Speed"
            uit_val_format = i
        ]

        ui_tool_numinput @@(tool_ent_attr rail aoffset) 0 1000 1 [
            @@@(ui_tool_ent_attr_props rail aoffset)
            uit_label = "Offset"
            uit_val_format = i
        ]
    ]
]
